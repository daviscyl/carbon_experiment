"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[325],{67064:function($e,U,s){s.r(U),s.d(U,{default:function(){return Re}});var X=s(13769),q=s.n(X),_=s(5574),y=s.n(_),ee=s(15009),i=s.n(ee),ae=s(97857),M=s.n(ae),re=s(99289),g=s.n(re),l=s(65024);function Ee(u){return C.apply(this,arguments)}function C(){return C=_asyncToGenerator(_regeneratorRuntime().mark(function u(n){return _regeneratorRuntime().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",request("/api/currentUser",_objectSpread({method:"GET"},n||{})));case 1:case"end":return a.stop()}},u)})),C.apply(this,arguments)}function De(u){return P.apply(this,arguments)}function P(){return P=_asyncToGenerator(_regeneratorRuntime().mark(function u(n){return _regeneratorRuntime().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",request("/api/login/outLogin",_objectSpread({method:"POST"},n||{})));case 1:case"end":return a.stop()}},u)})),P.apply(this,arguments)}function Oe(u,n){return Z.apply(this,arguments)}function Z(){return Z=_asyncToGenerator(_regeneratorRuntime().mark(function u(n,t){return _regeneratorRuntime().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.abrupt("return",request("/api/login/account",_objectSpread({method:"POST",headers:{"Content-Type":"application/json"},data:n},t||{})));case 1:case"end":return c.stop()}},u)})),Z.apply(this,arguments)}function Ie(u){return L.apply(this,arguments)}function L(){return L=_asyncToGenerator(_regeneratorRuntime().mark(function u(n){return _regeneratorRuntime().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",request("/api/notices",_objectSpread({method:"GET"},n||{})));case 1:case"end":return a.stop()}},u)})),L.apply(this,arguments)}function te(u,n){return A.apply(this,arguments)}function A(){return A=g()(i()().mark(function u(n,t){return i()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.abrupt("return",(0,l.request)("/api/rule",M()({method:"GET",params:M()({},n)},t||{})));case 1:case"end":return c.stop()}},u)})),A.apply(this,arguments)}function se(u){return $.apply(this,arguments)}function $(){return $=g()(i()().mark(function u(n){return i()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,l.request)("/api/rule",M()({method:"PUT"},n||{})));case 1:case"end":return a.stop()}},u)})),$.apply(this,arguments)}function ne(u){return E.apply(this,arguments)}function E(){return E=g()(i()().mark(function u(n){return i()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,l.request)("/api/rule",M()({method:"POST"},n||{})));case 1:case"end":return a.stop()}},u)})),E.apply(this,arguments)}function ue(u){return D.apply(this,arguments)}function D(){return D=g()(i()().mark(function u(n){return i()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,l.request)("/api/rule",M()({method:"DELETE"},n||{})));case 1:case"end":return a.stop()}},u)})),D.apply(this,arguments)}var le=s(24969),ie=s(18814),de=s(52457),oe=s(2236),ce=s(37476),B=s(5966),G=s(90672),pe=s(85307),v=s(2453),me=s(69677),ge=s(75081),O=s(71577),fe=s(85265),T=s(67294),V=s(88100),R=s(62113),I=s(64317),he=s(86615),ve=s(22452),Me=s(69400),e=s(85893),Fe=function(n){var t=(0,l.useIntl)();return(0,e.jsxs)(R.L,{stepsProps:{size:"small"},stepsFormRender:function(c,r){return(0,e.jsx)(Me.Z,{width:640,bodyStyle:{padding:"32px 40px 48px"},destroyOnClose:!0,title:t.formatMessage({id:"pages.searchTable.updateForm.ruleConfig",defaultMessage:"\u89C4\u5219\u914D\u7F6E"}),open:n.updateModalOpen,footer:r,onCancel:function(){n.onCancel()},children:c})},onFinish:n.onSubmit,children:[(0,e.jsxs)(R.L.StepForm,{initialValues:{name:n.values.name,desc:n.values.desc},title:t.formatMessage({id:"pages.searchTable.updateForm.basicConfig",defaultMessage:"\u57FA\u672C\u4FE1\u606F"}),children:[(0,e.jsx)(B.Z,{name:"name",label:t.formatMessage({id:"pages.searchTable.updateForm.ruleName.nameLabel",defaultMessage:"\u89C4\u5219\u540D\u79F0"}),width:"md",rules:[{required:!0,message:(0,e.jsx)(l.FormattedMessage,{id:"pages.searchTable.updateForm.ruleName.nameRules",defaultMessage:"\u8BF7\u8F93\u5165\u89C4\u5219\u540D\u79F0\uFF01"})}]}),(0,e.jsx)(G.Z,{name:"desc",width:"md",label:t.formatMessage({id:"pages.searchTable.updateForm.ruleDesc.descLabel",defaultMessage:"\u89C4\u5219\u63CF\u8FF0"}),placeholder:t.formatMessage({id:"pages.searchTable.updateForm.ruleDesc.descPlaceholder",defaultMessage:"\u8BF7\u8F93\u5165\u81F3\u5C11\u4E94\u4E2A\u5B57\u7B26"}),rules:[{required:!0,message:(0,e.jsx)(l.FormattedMessage,{id:"pages.searchTable.updateForm.ruleDesc.descRules",defaultMessage:"\u8BF7\u8F93\u5165\u81F3\u5C11\u4E94\u4E2A\u5B57\u7B26\u7684\u89C4\u5219\u63CF\u8FF0\uFF01"}),min:5}]})]}),(0,e.jsxs)(R.L.StepForm,{initialValues:{target:"0",template:"0"},title:t.formatMessage({id:"pages.searchTable.updateForm.ruleProps.title",defaultMessage:"\u914D\u7F6E\u89C4\u5219\u5C5E\u6027"}),children:[(0,e.jsx)(I.Z,{name:"target",width:"md",label:t.formatMessage({id:"pages.searchTable.updateForm.object",defaultMessage:"\u76D1\u63A7\u5BF9\u8C61"}),valueEnum:{0:"\u8868\u4E00",1:"\u8868\u4E8C"}}),(0,e.jsx)(I.Z,{name:"template",width:"md",label:t.formatMessage({id:"pages.searchTable.updateForm.ruleProps.templateLabel",defaultMessage:"\u89C4\u5219\u6A21\u677F"}),valueEnum:{0:"\u89C4\u5219\u6A21\u677F\u4E00",1:"\u89C4\u5219\u6A21\u677F\u4E8C"}}),(0,e.jsx)(he.Z.Group,{name:"type",label:t.formatMessage({id:"pages.searchTable.updateForm.ruleProps.typeLabel",defaultMessage:"\u89C4\u5219\u7C7B\u578B"}),options:[{value:"0",label:"\u5F3A"},{value:"1",label:"\u5F31"}]})]}),(0,e.jsxs)(R.L.StepForm,{initialValues:{type:"1",frequency:"month"},title:t.formatMessage({id:"pages.searchTable.updateForm.schedulingPeriod.title",defaultMessage:"\u8BBE\u5B9A\u8C03\u5EA6\u5468\u671F"}),children:[(0,e.jsx)(ve.Z,{name:"time",width:"md",label:t.formatMessage({id:"pages.searchTable.updateForm.schedulingPeriod.timeLabel",defaultMessage:"\u5F00\u59CB\u65F6\u95F4"}),rules:[{required:!0,message:(0,e.jsx)(l.FormattedMessage,{id:"pages.searchTable.updateForm.schedulingPeriod.timeRules",defaultMessage:"\u8BF7\u9009\u62E9\u5F00\u59CB\u65F6\u95F4\uFF01"})}]}),(0,e.jsx)(I.Z,{name:"frequency",label:t.formatMessage({id:"pages.searchTable.updateForm.object",defaultMessage:"\u76D1\u63A7\u5BF9\u8C61"}),width:"md",valueEnum:{month:"\u6708",week:"\u5468"}})]})]})},Te=Fe,be=["defaultRender"],je=function(){var u=g()(i()().mark(function n(t){var a;return i()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return a=v.ZP.loading("\u6B63\u5728\u6DFB\u52A0"),r.prev=1,r.next=4,ne(M()({},t));case 4:return a(),v.ZP.success("Added successfully"),r.abrupt("return",!0);case 9:return r.prev=9,r.t0=r.catch(1),a(),v.ZP.error("Adding failed, please try again!"),r.abrupt("return",!1);case 14:case"end":return r.stop()}},n,null,[[1,9]])}));return function(t){return u.apply(this,arguments)}}(),ye=function(){var u=g()(i()().mark(function n(t){var a;return i()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return a=v.ZP.loading("Configuring"),r.prev=1,r.next=4,se({name:t.name,desc:t.desc,key:t.key});case 4:return a(),v.ZP.success("Configuration is successful"),r.abrupt("return",!0);case 9:return r.prev=9,r.t0=r.catch(1),a(),v.ZP.error("Configuration failed, please try again!"),r.abrupt("return",!1);case 14:case"end":return r.stop()}},n,null,[[1,9]])}));return function(t){return u.apply(this,arguments)}}(),xe=function(){var u=g()(i()().mark(function n(t){var a;return i()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(a=v.ZP.loading("\u6B63\u5728\u5220\u9664"),t){r.next=3;break}return r.abrupt("return",!0);case 3:return r.prev=3,r.next=6,ue({key:t.map(function(x){return x.key})});case 6:return a(),v.ZP.success("Deleted successfully and will refresh soon"),r.abrupt("return",!0);case 11:return r.prev=11,r.t0=r.catch(3),a(),v.ZP.error("Delete failed, please try again"),r.abrupt("return",!1);case 16:case"end":return r.stop()}},n,null,[[3,11]])}));return function(t){return u.apply(this,arguments)}}(),Se=function(){var n=(0,T.useState)(!1),t=y()(n,2),a=t[0],c=t[1],r=(0,T.useState)(!1),x=y()(r,2),we=x[0],N=x[1],Ce=(0,T.useState)(!1),W=y()(Ce,2),z=W[0],k=W[1],b=(0,T.useRef)(),Pe=(0,T.useState)(),Y=y()(Pe,2),f=Y[0],S=Y[1],Ze=(0,T.useState)([]),K=y()(Ze,2),j=K[0],H=K[1],w=(0,l.useIntl)(),Le=(0,V.D3)(),Ae=Le.isLoading,J=[{title:(0,e.jsx)(l.FormattedMessage,{id:"pages.searchTable.updateForm.ruleName.nameLabel",defaultMessage:"Rule name"}),dataIndex:"name",tip:"The rule name is the unique key",render:function(d,o){return(0,e.jsx)("a",{onClick:function(){S(o),k(!0)},children:d})}},{title:(0,e.jsx)(l.FormattedMessage,{id:"pages.searchTable.titleDesc",defaultMessage:"Description"}),dataIndex:"desc",valueType:"textarea"},{title:(0,e.jsx)(l.FormattedMessage,{id:"pages.searchTable.titleCallNo",defaultMessage:"Number of service calls"}),dataIndex:"callNo",sorter:!0,hideInForm:!0,renderText:function(d){return"".concat(d).concat(w.formatMessage({id:"pages.searchTable.tenThousand",defaultMessage:" \u4E07 "}))}},{title:(0,e.jsx)(l.FormattedMessage,{id:"pages.searchTable.titleStatus",defaultMessage:"Status"}),dataIndex:"status",hideInForm:!0,valueEnum:{0:{text:(0,e.jsx)(l.FormattedMessage,{id:"pages.searchTable.nameStatus.default",defaultMessage:"Shut down"}),status:"Default"},1:{text:(0,e.jsx)(l.FormattedMessage,{id:"pages.searchTable.nameStatus.running",defaultMessage:"Running"}),status:"Processing"},2:{text:(0,e.jsx)(l.FormattedMessage,{id:"pages.searchTable.nameStatus.online",defaultMessage:"Online"}),status:"Success"},3:{text:(0,e.jsx)(l.FormattedMessage,{id:"pages.searchTable.nameStatus.abnormal",defaultMessage:"Abnormal"}),status:"Error"}}},{title:(0,e.jsx)(l.FormattedMessage,{id:"pages.searchTable.titleUpdatedAt",defaultMessage:"Last scheduled time"}),sorter:!0,dataIndex:"updatedAt",valueType:"dateTime",renderFormItem:function(d,o,h){var F=o.defaultRender,m=q()(o,be),Q=h.getFieldValue("status");return"".concat(Q)==="0"?!1:"".concat(Q)==="3"?(0,e.jsx)(me.Z,M()(M()({},m),{},{placeholder:w.formatMessage({id:"pages.searchTable.exception",defaultMessage:"Please enter the reason for the exception!"})})):F(d)}},{title:(0,e.jsx)(l.FormattedMessage,{id:"pages.searchTable.titleOption",defaultMessage:"Operating"}),dataIndex:"option",valueType:"option",render:function(d,o){return[(0,e.jsx)("a",{onClick:function(){N(!0),S(o)},children:(0,e.jsx)(l.FormattedMessage,{id:"pages.searchTable.config",defaultMessage:"Configuration"})},"config"),(0,e.jsx)("a",{href:"https://procomponents.ant.design/",children:(0,e.jsx)(l.FormattedMessage,{id:"pages.searchTable.subscribeAlert",defaultMessage:"Subscribe to alerts"})},"subscribeAlert")]}}];return Ae?(0,e.jsx)(ge.Z,{size:"large"}):(0,e.jsxs)(ie._z,{children:[(0,e.jsx)(de.Z,{headerTitle:w.formatMessage({id:"pages.searchTable.title",defaultMessage:"Enquiry form"}),actionRef:b,rowKey:"key",search:{labelWidth:120},toolBarRender:function(){return[(0,e.jsxs)(O.Z,{type:"primary",onClick:function(){c(!0)},children:[(0,e.jsx)(le.Z,{})," ",(0,e.jsx)(l.FormattedMessage,{id:"pages.searchTable.new",defaultMessage:"New"})]},"primary")]},request:te,columns:J,rowSelection:{onChange:function(d,o){H(o)}}}),(j==null?void 0:j.length)>0&&(0,e.jsxs)(oe.S,{extra:(0,e.jsxs)("div",{children:[(0,e.jsx)(l.FormattedMessage,{id:"pages.searchTable.chosen",defaultMessage:"Chosen"})," ",(0,e.jsx)("a",{style:{fontWeight:600},children:j.length})," ",(0,e.jsx)(l.FormattedMessage,{id:"pages.searchTable.item",defaultMessage:"\u9879"}),"\xA0\xA0",(0,e.jsxs)("span",{children:[(0,e.jsx)(l.FormattedMessage,{id:"pages.searchTable.totalServiceCalls",defaultMessage:"Total number of service calls"})," ",j.reduce(function(p,d){return p+d.callNo},0)," ",(0,e.jsx)(l.FormattedMessage,{id:"pages.searchTable.tenThousand",defaultMessage:"\u4E07"})]})]}),children:[(0,e.jsx)(O.Z,{onClick:g()(i()().mark(function p(){var d,o;return i()().wrap(function(F){for(;;)switch(F.prev=F.next){case 0:return F.next=2,xe(j);case 2:H([]),(d=b.current)===null||d===void 0||(o=d.reloadAndRest)===null||o===void 0||o.call(d);case 4:case"end":return F.stop()}},p)})),children:(0,e.jsx)(l.FormattedMessage,{id:"pages.searchTable.batchDeletion",defaultMessage:"Batch deletion"})}),(0,e.jsx)(O.Z,{type:"primary",children:(0,e.jsx)(l.FormattedMessage,{id:"pages.searchTable.batchApproval",defaultMessage:"Batch approval"})})]}),(0,e.jsxs)(ce.Y,{title:w.formatMessage({id:"pages.searchTable.createForm.newRule",defaultMessage:"New rule"}),width:"400px",open:a,onOpenChange:c,onFinish:function(){var p=g()(i()().mark(function d(o){var h;return i()().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,je(o);case 2:h=m.sent,h&&(c(!1),b.current&&b.current.reload());case 4:case"end":return m.stop()}},d)}));return function(d){return p.apply(this,arguments)}}(),children:[(0,e.jsx)(B.Z,{rules:[{required:!0,message:(0,e.jsx)(l.FormattedMessage,{id:"pages.searchTable.ruleName",defaultMessage:"Rule name is required"})}],width:"md",name:"name"}),(0,e.jsx)(G.Z,{width:"md",name:"desc"})]}),(0,e.jsx)(Te,{onSubmit:function(){var p=g()(i()().mark(function d(o){var h;return i()().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,ye(o);case 2:h=m.sent,h&&(N(!1),S(void 0),b.current&&b.current.reload());case 4:case"end":return m.stop()}},d)}));return function(d){return p.apply(this,arguments)}}(),onCancel:function(){N(!1),z||S(void 0)},updateModalOpen:we,values:f||{}}),(0,e.jsx)(fe.Z,{width:600,open:z,onClose:function(){S(void 0),k(!1)},closable:!1,children:(f==null?void 0:f.name)&&(0,e.jsx)(pe.vY,{column:2,title:f==null?void 0:f.name,request:g()(i()().mark(function p(){return i()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",{data:f||{}});case 1:case"end":return o.stop()}},p)})),params:{id:f==null?void 0:f.name},columns:J})})]})},Re=(0,V.u3)(Se)}}]);
